webpackJsonp([12],{Y24K:function(e,t){},jKLp:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("o/zv"),r=n.n(i),a=(n("YaEn"),n("SQ6o"));function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function o(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}var u={props:{type:{default:"tab"}},data:function(){return{visible:!1,top:0,left:0,fixedTags:[],selectedTag:{},currentViews:this.$route.name}},computed:{visitedViews:function(){return this.$store.state.viewsBar.visitedViews}},watch:{$route:function(){this.currentViews=this.$route.name,this.addViewTags(),"tag"==this.type&&this.moveToCurrentTag()},visible:function(e){e?document.body.addEventListener("click",this.closeMenu):document.body.removeEventListener("click",this.closeMenu)}},mounted:function(){this.initTags(),this.addViewTags()},methods:{isActive:function(e){return e.path===this.$route.path},filterFixedViews:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",i=[];return e.forEach(function(e){if(e.fixed){var a=r.a.resolve(n,e.path);i.push({fullPath:a,path:a,name:e.name,fixed:e.meta&&e.meta.fixed})}if(e.children){var s=t.filterFixedViews(e.children,e.path);s.length>=1&&(i=[].concat(o(i),o(s)))}}),i},initTags:function(){var e,t=s(this.fixedTags=this.filterFixedViews(a.a.getDynamicRouters()));try{for(t.s();!(e=t.n()).done;){var n=e.value;n.name&&this.$store.dispatch("addVisitedView",n)}}catch(e){t.e(e)}finally{t.f()}},addViewTags:function(){return this.$route.name&&this.$store.dispatch("addView",this.$route),!1},moveToCurrentTag:function(){var e=this,t=this.$refs.tag;this.$nextTick(function(){var n,i=s(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.$el.dataset.path===e.$route.path){e.moveToTarget(r),r.fullPath!==e.$route.fullPath&&e.$store.dispatch("updateVisitedView",e.$route);break}}}catch(e){i.e(e)}finally{i.f()}})},refreshSelectedTag:function(e){var t=e.fullPath;if(t==this.$route.fullPath)return this.$router.replace("/"),void this.$router.replace(t);this.$router.replace(t)},closeTag:function(e){var t=this.visitedViews.filter(function(t){return t.path==e})[0];this.closeSelectedTag(t)},clickTag:function(e){this.$route.path!=e&&this.$router.push(e)},closeSelectedTag:function(e){var t=this;this.$store.dispatch("delView",e).then(function(n){var i=n.visitedViews;if(t.isActive(e)){var r=i.slice(-1)[0];r?t.$router.push(r.path):t.$router.push("/")}})},closeOthersTags:function(){var e=this;this.$router.push(this.selectedTag),this.$store.dispatch("delOthersViews",this.selectedTag).then(function(){e.moveToCurrentTag()})},closeAllTags:function(e){var t=this;this.$store.dispatch("delAllViews").then(function(n){var i=n.visitedViews;t.fixedTags.some(function(t){return t.path===e.path})||t.toLastView(i,e)})},toLastView:function(e,t){var n=e.slice(-1)[0];n?this.$router.push(n):"首页"===t.name?this.$router.replace({path:t.fullPath}):this.$router.push("/")},openMenu:function(e,t){var n=this.$el.getBoundingClientRect().left,i=this.$el.offsetWidth+n-105,r=t.clientX+5;this.left=r>i?i:r,this.top=t.clientY,this.visible=!0,this.selectedTag=e},closeMenu:function(){this.visible=!1},handleScroll:function(e){var t=-e.wheelDelta||40*-e.deltaY,n=this.$refs.scrollContainer.$refs.wrap;n.scrollLeft=n.scrollLeft+t/4},moveToTarget:function(e){var t=this.$refs.scrollContainer.$el.offsetWidth,n=this.$refs.scrollContainer.$refs.wrap,i=this.$refs.tag,r=null,a=null,s=null,o=null;i.length>0&&(r=i[0],a=i[i.length-1]);for(var l=0;l<i.length;l++)if(i[l]===e){0===l?o=i[l].length>1&&i[l+1]:l===i.length-1?s=i[l].length>1&&i[l-1]:(s=i[l-1],o=i[l+1]);break}if(r===e)n.scrollLeft=0;else if(a===e)n.scrollLeft=n.scrollWidth-t;else{var c=o.$el.offsetLeft+o.$el.offsetWidth+4,u=s.$el.offsetLeft-4;c>n.scrollLeft+t?n.scrollLeft=c-t:u<n.scrollLeft&&(n.scrollLeft=u)}},tabClick:function(e){var t=e.$el.dataset.path;this.$route.path!=t&&this.$router.push(t)},removeView:function(e){var t=this.visitedViews.filter(function(t){return t.name==e})[0];this.closeSelectedTag(t)}}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["tag"==e.type?n("div",{staticClass:"views-container"},[n("el-scrollbar",{ref:"scrollContainer",staticClass:"scroll-container",attrs:{vertical:!1},nativeOn:{wheel:function(t){return t.preventDefault(),e.handleScroll.apply(null,arguments)}}},e._l(e.visitedViews,function(t){return n("el-tag",{key:t.path,ref:"tag",refInFor:!0,staticClass:"view-item",attrs:{type:e.isActive(t)?"":"info",closable:!t.fixed,size:"medium","data-path":t.path},on:{close:function(n){return e.closeTag(t.path)},click:function(n){return e.clickTag(t.path)}},nativeOn:{contextmenu:function(n){return n.preventDefault(),e.openMenu(t,n)}}},[e._v(e._s(t.name))])}),1),e._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"contextmenu",style:{left:e.left+"px",top:e.top+"px"}},[n("li",{on:{click:function(t){return e.refreshSelectedTag(e.selectedTag)}}},[e._v("刷新")]),e._v(" "),e.selectedTag.fixed?e._e():n("li",{on:{click:function(t){return e.closeSelectedTag(e.selectedTag)}}},[e._v("关闭")]),e._v(" "),n("li",{on:{click:e.closeOthersTags}},[e._v("关闭其他")]),e._v(" "),n("li",{on:{click:function(t){return e.closeAllTags(e.selectedTag)}}},[e._v("关闭所有")])])],1):e._e(),e._v(" "),"tab"==e.type?n("div",{staticClass:"tab-views"},[n("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.tabClick,"tab-remove":e.removeView},model:{value:e.currentViews,callback:function(t){e.currentViews=t},expression:"currentViews"}},e._l(e.visitedViews,function(t){return n("el-tab-pane",{key:t.name,ref:"tag",refInFor:!0,attrs:{"data-path":t.path,label:t.name,closable:!t.fixed,name:t.name},nativeOn:{contextmenu:function(n){return n.preventDefault(),e.openMenu(t,n)}}})}),1)],1):e._e()])},staticRenderFns:[]};var h=n("VU/8")(u,f,!1,function(e){n("yj4N"),n("Y24K")},"data-v-61c18c56",null);t.default=h.exports},yj4N:function(e,t){}});